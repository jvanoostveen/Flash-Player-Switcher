<?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark"
	xmlns:mx="library://ns.adobe.com/flex/mx" 
						xmlns:flashplayerswitcher="flashplayerswitcher.*"
						xmlns:view="flashplayerswitcher.view.*"
						backgroundColor="#F4F4F2" width="100%" height="100%" showStatusBar="false"
						applicationComplete="onInit()">
	
	<fx:Declarations>
		<flashplayerswitcher:FlashPlayerSwitcherContext id="context" contextView="{this}" />
	</fx:Declarations>

	<fx:Script>
		<![CDATA[
			import mx.collections.ArrayCollection;
			import mx.controls.Alert;
			import mx.events.FlexEvent;
			
			[Bindable]
			public var dummyData:ArrayCollection = new ArrayCollection();
			
			private function onInit():void
			{
				if (Capabilities.os.indexOf("Mac OS") == -1)
				{
					Alert.show("Only Mac OS X is supported.", "Unsupported platform");
					return;
				}
				
				context.dispatchEvent(new FlexEvent(FlexEvent.APPLICATION_COMPLETE));
				
//				listing.addEventListener(GridSelectionEvent.SELECTION_CHANGE, handleSelectionChange);
//				installButton.addEventListener(MouseEvent.CLICK, handleInstallButtonClick);
			}
			
//			private function handleInstallButtonClick(event:MouseEvent):void
//			{
//				if (listing.selectedIndex == -1)
//					return;
//				
//				var bundle:FlashPlayerBundle = listing.selectedItem as FlashPlayerBundle;
//				
//				// #1 plugin
//				var plugin:File = File.applicationStorageDirectory.resolvePath("FlashPlayers/" + bundle.version + "-debug" + "/" + "Flash Player.plugin");
//				var pluginTarget:File = File.userDirectory.resolvePath("Library/Internet Plug-Ins/Flash Player.plugin");
//				plugin.copyTo(pluginTarget, true);
//				
//				// #2 xpt
//				var xpt:File = File.applicationStorageDirectory.resolvePath("FlashPlayers/" + bundle.version + "-debug" + "/" + "flashplayer.xpt");
//				var xptTarget:File = File.userDirectory.resolvePath("Library/Internet Plug-Ins/flashplayer.xpt");
//				xpt.copyTo(xptTarget, true);
//				
//				Alert.show("Flash Player switched. Restart your browser(s).", "Flash Player switched");
//			}
//
//			private function handleSelectionChange(event:GridSelectionEvent):void
//			{
//				if (listing.selectedIndex == -1)
//				{
//					installButton.enabled = false;
//					deleteButton.enabled = false;
//					
//					return;
//				}
//				
//				installButton.enabled = true;
//			}
		]]>
	</fx:Script>
	<s:Group x="0" y="0">
		<s:Image x="10" y="10" smooth="true" source="@Embed('flashplayerswitcher/logo.png')"/>
		<s:Label x="161" y="36" fontSize="48" text="Flash Player Switcher"/>
		<s:TextArea x="161" y="84" width="359" height="45" borderVisible="false"
					contentBackgroundAlpha="0.0" editable="false"
					text="Flash Player Switcher makes use of '~/Library/Internet Plug-Ins/'. No systemwide Flash Player plugin will be overwritten."/>
	</s:Group>
	<view:InstalledVersionListing x="429" y="177" width="249" height="200"/>
	<view:FlashplayerListing x="26" y="176" />
</s:WindowedApplication>
